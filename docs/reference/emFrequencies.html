<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>emFrequencies: simple effect analysis of frequency data. — emFrequencies • ANOFA</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="emFrequencies: simple effect analysis of frequency data. — emFrequencies"><meta property="og:description" content="The function emFrequencies() performs a simple effect analyses
of frequencies after an omnibus analysis has been obtained with anofa()
according to the ANOFA framework. See (Laurencelle and Cousineau 2023)
 for more."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ANOFA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/WhatIsANOFA.html">What is Analysis of Frequency Data?</a>
    </li>
    <li>
      <a href="../articles/DataFormatsForFrequencies.html">Data formats for frequencies</a>
    </li>
    <li>
      <a href="../articles/ConfidenceIntervals.html">Confidence intervals with frequencies</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dcousin3/ANOFA/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>emFrequencies: simple effect analysis of frequency data.</h1>
    <small class="dont-index">Source: <a href="https://github.com/dcousin3/ANOFA/blob/HEAD/R/ANOFA-emFrequencies.R" class="external-link"><code>R/ANOFA-emFrequencies.R</code></a></small>
    <div class="hidden name"><code>emFrequencies.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function <code>emFrequencies()</code> performs a simple effect analyses
of frequencies after an omnibus analysis has been obtained with <code><a href="anofa.html">anofa()</a></code>
according to the ANOFA framework. See (Laurencelle and Cousineau 2023)
 for more.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">emFrequencies</span><span class="op">(</span><span class="va">w</span>, <span class="va">formula</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>w</dt>
<dd><p>An ANOFA object obtained from <code><a href="anofa.html">anofa()</a></code>;</p></dd>


<dt>formula</dt>
<dd><p>A formula which indicates what simple effect to analyze.
only one simple effect formula at a time can be analyzed. The formula
is given using a vertical bar, e.g., <code> ~ factorA | factorB</code> to obtain
the effect of Factor A within every level of the Factor B.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>a model fit of the simple effect.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>emFrequencies computes expected marginal frequencies and
analyze the hypothesis of equal frequencies.
The sum of the Gs of the simple effects are equal to the
interaction and main effect Gs, as this is an additive decomposition
of the effects.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Laurencelle L, Cousineau D (2023).
“Analysis of frequency tables: The ANOFA framework.”
<em>The Quantitative Methods for Psychology</em>, <b>19</b>, 173--193.
<a href="https://doi.org/10.20982/tqmp.19.2.p173" class="external-link">doi:10.20982/tqmp.19.2.p173</a>
.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Basic example using a two-factors design with the data in compiled format. </span></span></span>
<span class="r-in"><span><span class="co"># Ficticious data present frequency of observation classified according</span></span></span>
<span class="r-in"><span><span class="co"># to Intensity (three levels) and Pitch (two levels) for 6 possible cells.</span></span></span>
<span class="r-in"><span><span class="va">minimalExample</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Intensity Pitch Frequency</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       Low  Soft         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    Medium  Soft         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      High  Soft         5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       Low  Hard         4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    Medium  Hard         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      High  Hard         4</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># performs the omnibus analysis first (mandatory):</span></span></span>
<span class="r-in"><span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="anofa.html">anofa</a></span><span class="op">(</span><span class="va">Frequency</span> <span class="op">~</span> <span class="va">Intensity</span> <span class="op">*</span> <span class="va">Pitch</span>, <span class="va">minimalExample</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      G df Gcorrected pvalue  etasq</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total           2.2530  5         NA     NA     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intensity       1.2607  2      1.220 0.5433 0.0593</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pitch           0.0000  1      0.000 1.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intensity:Pitch 0.9923  2      0.866 0.6486 0.1012</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># execute the simple effect of Pitch for every levels of Intensity</span></span></span>
<span class="r-in"><span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu">emFrequencies</span><span class="op">(</span><span class="va">w</span>, <span class="op">~</span> <span class="va">Pitch</span> <span class="op">|</span> <span class="va">Intensity</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     G df Gcorrected pvalue   etasq</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pitch | Low    0.6796  1     0.6630 0.7178 0.10174</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pitch | Medium 0.2014  1     0.1964 0.9064 0.03871</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pitch | High   0.1113  1     0.1086 0.9471 0.01222</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># As a check, you can verify that the Gs are decomposed additively</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">e</span><span class="op">$</span><span class="va">results</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9922922</span>
<span class="r-in"><span><span class="va">w</span><span class="op">$</span><span class="va">results</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="va">w</span><span class="op">$</span><span class="va">results</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">1</span><span class="op">]</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9922922</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Real-data example using a two-factor design with the data in compiled format:</span></span></span>
<span class="r-in"><span><span class="va">LandisBarrettGalvin2013</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    provider program obsfreq</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     MC/MA     CBH      19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     MC/MA     PBH      18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     MC/MA      BM       2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4        MC     CBH      24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5        MC     PBH      53</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6        MC      BM       3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7        MA     CBH      44</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8        MA     PBH      57</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9        MA      BM       5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10       $P     CBH      20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11       $P     PBH      57</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12       $P      BM       3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13       PI     CBH      63</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14       PI     PBH     165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15       PI      BM      20</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="anofa.html">anofa</a></span><span class="op">(</span> <span class="va">obsfreq</span> <span class="op">~</span> <span class="va">provider</span> <span class="op">*</span> <span class="va">program</span>, <span class="va">LandisBarrettGalvin2013</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="count.html">anofaPlot</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> superb::FYI: Running initializer init.count</span>
<span class="r-plt img"><img src="emFrequencies-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       G df Gcorrected  pvalue  etasq</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total            533.19 14         NA      NA     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> provider         206.57  4     206.20 0.00000 0.2720</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> program          307.77  2     307.40 0.00000 0.3576</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> provider:program  18.85  8      18.69 0.01662 0.4909</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># there is an interaction, so look for simple effects</span></span></span>
<span class="r-in"><span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu">emFrequencies</span><span class="op">(</span><span class="va">w</span>, <span class="op">~</span> <span class="va">program</span> <span class="op">|</span> <span class="va">provider</span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      G df Gcorrected   pvalue  etasq</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> program | MC/MA  18.65  2      18.63 0.000931 0.3235</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> program | MC     54.64  2      54.58 0.000000 0.4058</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> program | MA     54.27  2      54.20 0.000000 0.3386</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> program | $P     61.98  2      61.91 0.000000 0.4365</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> program | PI    137.08  2     136.91 0.000000 0.3560</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example from Gillet1993 : 3 factors for appletrees </span></span></span>
<span class="r-in"><span><span class="va">Gillet1993</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     species location florished Freq</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  Jonagold   Order1       Yes    8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  Jonagold   Order1        No   14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  Jonagold   Order2       Yes  102</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  Jonagold   Order2        No  186</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  Jonagold   Order3       Yes   84</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  Jonagold   Order3        No   79</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7       Cox   Order1       Yes   16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8       Cox   Order1        No    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9       Cox   Order2       Yes   58</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10      Cox   Order2        No   88</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11      Cox   Order3       Yes   22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12      Cox   Order3        No   53</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="anofa.html">anofa</a></span><span class="op">(</span> <span class="va">Freq</span> <span class="op">~</span> <span class="va">species</span> <span class="op">*</span> <span class="va">location</span> <span class="op">*</span> <span class="va">florished</span>, <span class="va">Gillet1993</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu">emFrequencies</span><span class="op">(</span><span class="va">w</span>, <span class="op">~</span> <span class="va">florished</span> <span class="op">|</span> <span class="va">location</span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Again, as a check, you can verify that the Gs are decomposed additively</span></span></span>
<span class="r-in"><span><span class="va">w</span><span class="op">$</span><span class="va">results</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="va">w</span><span class="op">$</span><span class="va">results</span><span class="op">[</span><span class="fl">7</span>,<span class="fl">1</span><span class="op">]</span> <span class="co"># B + B:C</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 34.34593</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">e</span><span class="op">$</span><span class="va">results</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 34.34593</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># You can ask easier outputs with</span></span></span>
<span class="r-in"><span><span class="fu"><a href="summarize.html">summarize</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="co"># or summary(w) for the ANOFA table only</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                    G df Gcorrected   pvalue   etasq</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total                      515.97724 11         NA       NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> species                     77.55830  1   77.50394 0.000000 0.09811</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> location                   379.25702  2  378.90274 0.000000 0.34722</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> florished                   24.95517  1   24.93768 0.000001 0.03382</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> species:location             3.31188  2    3.29839 0.192205 0.39222</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> species:florished            0.06801  1    0.06777 0.794610 0.12578</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> location:florished           9.39076  2    9.35250 0.009314 0.36712</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> species:location:florished  21.43610  2   21.08372 0.000026 0.41984</span>
<span class="r-in"><span><span class="fu"><a href="explain.html">explain</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span>   <span class="co"># human-readable ouptut ((pending))</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "method explain not yet done..."</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Denis Cousineau.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

